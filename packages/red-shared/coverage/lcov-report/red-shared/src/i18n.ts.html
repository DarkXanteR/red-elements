<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for red-shared/src/i18n.ts</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../../prettify.css" />
    <link rel="stylesheet" href="../../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../../index.html">All files</a> / <a href="index.html">red-shared/src</a> i18n.ts
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">9.62% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>5/52</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">20% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>3/15</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>0/23</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">10.64% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>5/47</span>
      </div>
    </div>
  </div>
  <div class='status-line low'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * Copyright JS Foundation and other contrib<span class="fstat-no" title="function not covered" >ut</span>ors, http://js.foundation
 *<span class="cstat-no" title="statement not covered" ><span class="fstat-no" title="function not covered" ></span></span>
 * Licensed under<span class="fstat-no" title="function not covered" > the Apach</span>e License<span class="cstat-no" title="statement not covered" >, Vers<span class="cstat-no" title="statement not covered" >ion 2.0 (the "License");<span class="cstat-no" title="statement not covered" ></span></span></span>
 * you may not us<span class="fstat-no" title="function not covered" >e this fi</span>le except<span class="cstat-no" title="statement not covered" > in co<span class="cstat-no" title="statement not covered" >mpliance with the License.<span class="cstat-no" title="statement not covered" ></span></span></span>
 * You may obtain<span class="fstat-no" title="function not covered" > a co</span>py of the <span class="cstat-no" title="statement not covered" >License at<span class="cstat-no" title="statement not covered" ><span class="fstat-no" title="function not covered" ></span></span></span>
 *<span class="cstat-no" title="statement not covered" ></span>
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 **/
import {
  Context
} from './context'
import * as i18n from 'i18next'
&nbsp;
export class I18n extends Context {
  public i18n: any
&nbsp;
  constructor() {
    super()
    const { ctx } = this
    ctx._ = () =&gt; {
      return i18n.t.apply(null, arguments);
<span class="fstat-no" title="function not covered" >    }</span>
    this<span class="cstat-no" title="statement not covered" >.i18n = i</span>18n;
  }<span class="cstat-no" title="statement not covered" ></span>
<span class="cstat-no" title="statement not covered" ><span class="fstat-no" title="function not covered" ></span></span>
  async init<span class="cstat-no" title="statement not covered" >() {</span>
    try {
      aw<span class="cstat-no" title="statement not covered" >ait this.i18n.init</span>({
        resGetPath: 'locales/__ns__?lng=__lng__',
<span class="fstat-no" title="function not covered" ></span>        dynamicLoad: false,
<span class="cstat-no" title="statement not covered" >        load: 'current',<span class="fstat-no" title="function not covered" ></span></span>
        ns: <span class="cstat-no" title="statement not covered" >{</span>
          namesp<span class="cstat-no" title="statement not covered" >aces: ["editor", "node-red", "jsonata", "infotips"],</span>
          defaultNs: "editor"
        },
        fallbackLng: ['en-US'],
        useCookie: false
      })
      return this.i18n.t.apply(null, arguments)
    } catch (err) {
      console.error(err)
      throw err
    }
  }<span class="cstat-no" title="statement not covered" ></span>
&nbsp;
  initCb(cb) {
    this.i18n.in<span class="cstat-no" title="statement not covered" >it({</span>
      resGetPath<span class="cstat-no" title="statement not covered" >: 'locales/</span>__ns__?lng=__lng__',
      dynamicLoad: false,
      load: 'current',
      ns: {
<span class="fstat-no" title="function not covered" ></span>        namespaces: ["editor", "node-red", "jsonata", "infotips"],
<span class="cstat-no" title="statement not covered" >        defaultNs: "editor"</span>
      },
      fallbackLng: ['en-US'],
      useCookie: false
    }, (err, t) =&gt; {
      this.i18n.t.apply(null, arguments)
      if (cb) {
        cb(this.i18n)
      }
    })
<span class="fstat-no" title="function not covered" ></span>
  }<span class="cstat-no" title="statement not covered" ></span>
<span class="cstat-no" title="statement not covered" ></span>
  async loadCata<span class="cstat-no" title="statement not covered" >log(namespace) </span>{
    var languageList = i18n.functions.toLanguages(i18n.detectLanguage());
    var toLoad = languageList.length;
    return new Promise((resolve, reject) =&gt; {
<span class="fstat-no" title="function not covered" ></span>      languageList.forEach(function (lang) {
<span class="cstat-no" title="statement not covered" >        $.ajax({<span class="fstat-no" title="function not covered" ></span></span>
          headers: {<span class="cstat-no" title="statement not covered" ></span>
            "Accept": "ap<span class="cstat-no" title="statement not covered" >plication/json"</span>
          },<span class="cstat-no" title="statement not covered" ><span class="fstat-no" title="function not covered" ></span></span>
          cache:<span class="cstat-no" title="statement not covered" > false,<span class="fstat-no" title="function not covered" ></span></span>
          url: 'loca<span class="cstat-no" title="statement not covered" >les/' + namespace + '?lng=' + lang,</span>
          success: function (data) {
            i18n.addResourceBundle(lang, namespace, data);
            toLoad--;
            if (toLoad === 0) {
              resolve();
            }<span class="fstat-no" title="function not covered" ></span>
          }<span class="cstat-no" title="statement not covered" ></span>
        });<span class="cstat-no" title="statement not covered" ></span>
      })<span class="cstat-no" title="statement not covered" ></span>
    })<span class="cstat-no" title="statement not covered" ></span>
  }
&nbsp;
  async loadNodeCatalogs(done) {
    var languageList = i18n.functions.toLanguages(i18n.detectLanguage());
    var toLoad = languageList.length;
    return new Promise((resolve, reject) =&gt; {
      languageList.forEach(function (lang) {
<span class="fstat-no" title="function not covered" ></span>        $.ajax({
<span class="cstat-no" title="statement not covered" >          headers: {<span class="fstat-no" title="function not covered" ></span></span>
            "Accept": "applicat<span class="cstat-no" title="statement not covered" >ion/json"</span>
          },<span class="cstat-no" title="statement not covered" ></span>
          ca<span class="cstat-no" title="statement not covered" >che: false,<span class="fstat-no" title="function not covered" ></span></span>
          url: '<span class="cstat-no" title="statement not covered" >locales/nodes?lng=' +<span class="fstat-no" title="function not covered" > l</span>ang,</span>
          success: f<span class="cstat-no" title="statement not covered" >unction (data) {</span>
            var namespaces = Object.keys(data);
            namespaces.forEach(function (ns) {
              i18n.addResourceBundle(lang, ns, data[ns]);
            });
            toLoad--;
            if (toLoad === 0) {<span class="fstat-no" title="function not covered" ></span>
              resolve();<span class="cstat-no" title="statement not covered" ></span>
            }<span class="cstat-no" title="statement not covered" ><span class="fstat-no" title="function not covered" ></span></span>
          }<span class="cstat-no" title="statement not covered" ></span>
        });
      })<span class="cstat-no" title="statement not covered" ></span>
    })<span class="cstat-no" title="statement not covered" ></span>
  }<span class="cstat-no" title="statement not covered" ></span>
}
&nbsp;</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="https://istanbul.js.org/" target="_blank">istanbul</a> at Thu Dec 28 2017 10:14:52 GMT+0700 (+07)
</div>
</div>
<script src="../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../sorter.js"></script>
</body>
</html>
